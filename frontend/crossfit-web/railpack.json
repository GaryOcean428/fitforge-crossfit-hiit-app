{
  "$schema": "https://schema.railpack.com",
  "provider": "node",
  "packages": {
    "node": "20"
  },
  "steps": {
    "install": {
      "commands": [
        "pnpm install --frozen-lockfile"
      ],
      "caches": ["pnpm-cache", "node-modules-cache"]
    },
    "build": {
      "inputs": [{ "step": "install" }],
      "commands": [
        "pnpm build"
      ],
      "caches": ["vite-cache"]
    }
  },
  "caches": {
    "pnpm-cache": {
      "directory": "/root/.local/share/pnpm/store",
      "type": "shared"
    },
    "node-modules-cache": {
      "directory": "node_modules/.cache",
      "type": "shared"
    },
    "vite-cache": {
      "directory": ".vite/cache",
      "type": "shared"
    }
  },
  "deploy": {
    "base": {
      "image": "ghcr.io/railwayapp/railpack-runtime:latest"
    },
    "startCommand": "pnpm preview --host 0.0.0.0 --port $PORT",
    "variables": {
      "NODE_ENV": "production"
    },
    "inputs": [
      {
        "step": "build",
        "include": [
          "dist",
          "package.json",
          "pnpm-lock.yaml",
          "vite.config.js"
        ]
      }
    ]
  }
}

