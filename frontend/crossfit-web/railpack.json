{
  "$schema": "https://schema.railpack.com",
  "provider": "node",
  "packages": {
    "node": "20"
  },
  "steps": {
    "install": {
      "commands": [
        "pnpm install --frozen-lockfile"
      ],
      "caches": ["pnpm-cache", "node-modules-cache"]
    },
    "build": {
      "inputs": [{ "step": "install" }],
      "commands": [
        "pnpm build"
      ],
      "caches": ["vite-cache"]
    }
  },
  "caches": {
    "pnpm-cache": {
      "directory": "/root/.local/share/pnpm/store",
      "type": "shared"
    },
    "node-modules-cache": {
      "directory": "node_modules/.cache",
      "type": "shared"
    },
    "vite-cache": {
      "directory": ".vite/cache",
      "type": "shared"
    }
  },
  "deploy": {
    "base": {
      "image": "nginx:alpine"
    },
    "staticFiles": {
      "from": "dist",
      "to": "/usr/share/nginx/html"
    },
    "configFiles": [
      {
        "from": "nginx.conf",
        "to": "/etc/nginx/conf.d/default.conf"
      }
    ],
    "startCommand": "nginx -g 'daemon off;'",
    "variables": {
      "NODE_ENV": "production"
    },
    "inputs": [
      {
        "step": "build",
        "include": [
          "dist",
          "nginx.conf"
        ]
      }
    ]
  }
}

